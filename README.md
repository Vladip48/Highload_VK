# Яндекс.Такси

## Содержание
- [1. Тема и целевая аудитория](#1-тема-и-целевая-аудитория)
  - [1.1 Тема](#11-тема)
  - [1.2 Функционал MVP](#12-функционал-mvp)
  - [1.3 Целевая аудитория](#13-целевая-аудитория)
- [2. Расчет нагрузки](#2-расчет-нагрузки)
  - [2.1 Продуктовые метрики](#21-продуктовые-метрики)
  - [2.2 Технические метрики](#22-технические-метрики)
    - [2.2.1 Размер хранения данных](#221-размер-хранения-данных)
    - [2.2.2 Сетевой трафик](#222-сетевой-трафик)
    - [2.2.3 RPS](#223-rps)
- [Список источников](#список-источников)

## 1. Тема и целевая аудитория

### 1.1 Тема

Яндекс.Такси - сервис мобильного заказа такси, входящий в экосистему Яндекс Go. Позволяет пользователям находить ближайших водителей, отслеживать поездку в реальном времени и оплачивать поездки через приложение. Сервис работает в России, странах СНГ и ряде других регионов.

### 1.2 Функционал MVP

- Авторизация пользователя
- Отправка запроса на вызов такси
- Поиск ближайших свободных водителей  
- Назначение заказа одному из водителей  
- Отслеживание поездки в реальном времени 
- Расчёт стоимости поездки и оплата
- Рейтинг водителей

### 1.3 Целевая аудитория

- **География:** Россия, Казахстан, Армения, Грузия, Узбекистан  
- **Размер аудитории:**  
  - Месячная аудитория - 53,2 млн пользователей [1]
  - Дневная аудитория - 14 млн пользователей  

- **Средний возраст:** 25-45 лет  
- **Устройства:** 85% - мобильные, 15% - десктоп  

## 2. Расчет нагрузки

### 2.1 Продуктовые метрики

#### Исходные данные

| Метрика | Значение | Источник |
|---------|----------|----------|
| **MAU (Monthly Active Users)** | 53,2 млн | ТАСС [1]|
| **DAU (Daily Active Users)** | 14 млн | MAU × 27% |
| **Общее количество водителей** | 2,1 млн | Yandex Annual Report 2024 [2]|
| **Среднее число поездок на пользователя/мес** | 7,2 | Экстраполяция из данных по РФ [4] на 2021 год + надбавка с учетом количества поездок на такси за год [11]|
| **Годовое количество поездок** | 2,7 млрд | Экстраполяция из данных по РФ [4] на 2021 год + надбавка с учетом количества поездок на такси за год [11]|

#### Основные продуктовые метрики

| Метрика | Значение | Обоснование + Источник |
|---------|----------|----------|
| **Средний размер профиля пользователя** | 15 КБ на запись | Структура хранения на одного пользователя: <br>• Личные данные (телефон, имя, email) — ~1 КБ <br>• Фото профиля — ~0,5 КБ <br>• Платежные токены и избранные адреса — ~3 КБ <br>• Накладные расходы СУБД — ~10,5 КБ|
| **Средний размер истории поездок (на 1 пользователя/мес)** | 0,5 МБ | Одна запись о поездке (маршрут, стоимость, время, ID водителя) ≈ 70 КБ. <br>При 7,2 поездках в месяц: 7,2 × 70 КБ ≈ 500 КБ |
| **Авторизация / Обновление сессии** | 1.5 запроса в день на пользователя | Включает вход в приложение, фоновое обновление токена, повторная авторизация при сбое.|
| **Запрос на вызов такси (в день на пользователя)** | 0,53 запроса | Отношение суточного количества поездок к DAU. (2,7 млрд поездок в год / 365 дней) / 14 млн DAU ≈ 7,4 млн / 14 млн|
| **Запросов геолокации (трекинг) во время поездки** | 240 запросов на поездку | Средняя длительность поездки — 20 минут. [12] <br>Интервал отправки координат — 5 секунд. <br>20 мин × 60 сек / 5 сек = 240 пакетов|
| **Оплата поездки** | 0,53 действия в день | Совершается после завершения каждой поездки (автоматически или наличными). Коррелирует с метрикой «Запрос на вызов» 1 к 1|
| **Оценка поездки (рейтинг)** | 0,27 действия в день | Оценка является опциональной. Принят коэффициент конверсии 50% от числа завершенных поездок. <br>0,53 (поездок) × 0,5 = 0,265 ≈ 0,27|

### 2.2 Технические метрики
### 2.2.1 Размер хранения данных
- **Пользователи и Водители** 
  - Всего учетных записей: 53,2 млн (пользователи) + 2,1 млн (водители) ≈ 55,3 млн записей
  - Объем: 55,3 млн × 15 КБ ≈ 830 ГБ.
- **История поездок**
  - 2,7 млрд поездок в год
  - Объем одной записи (маршрут, метаданные, лог статусов) ~100 КБ
  - Объем: 2,7 млрд × 100 КБ ≈ 270 ТБ в год
- **Логи и телеметрия**
  - Обычно превышают объем бизнес-данных в 3–5 раз, примем средний коэффициент 4
  - Объем: 270 ТБ × 4 ≈ 1 080 ТБ в год

### 2.2.2 Сетевой трафик
Для обеспечения отказоустойчивости введен коэффициент пиковой нагрузки равный 4.

**API-трафик (бизнес-логика)** 

Включает запросы на создание заказа, оплату, поиск водителей и авторизацию. Средний размер транзакции (запрос + ответ) оценен в 5 КБ (JSON + заголовки).

При средней нагрузке ~2 100 запросов в секунду суточный объем составляет около 897 Гбайт/сутки.

С учетом коэффициента 4 пиковая скорость передачи данных достигает 0,33 Гбит/с.

**Телеметрический трафик (GPS-трекинг)**
  
Наиболее массовый тип запросов, обеспечивающий отображение автомобилей на карте в реальном времени. Отправка координат происходит каждые 5 секунд (240 пакетов на поездку). Размер компактного бинарного пакета (Protobuf) — 0,5 КБ.

При потоке ~20 500 пакетов в секунду суточный объем составляет около 888 Гбайт/сутки.

С учетом коэффициента 4 пиковая скорость передачи данных достигает 0,33 Гбит/с.

**Статический контент (CDN)**

Включает загрузку карт, изображений автомобилей, аватаров и интерфейсных элементов. Средний объем данных на сессию пользователя оценен в 50 МБ. Данный трафик обслуживается сетью доставки контента (CDN) и не нагружает основные серверы приложений.

Суточный объем: 14 млн пользователей × 50 МБ ≈ 700 Тбайт/сутки.

**Итоговые требования к сетевому интерфейсу**

Суммарный суточный трафик: 1 785 Гбайт/сутки (1,8 ТБ).

Пиковая пропускная способность: 0,66 Гбит/с.

### 2.2.3 RPS

| Тип запроса (Endpoint) | Описание | Кол-во в сутки (млн) | RPS (Средний) | RPS (Пиковый) | Обоснование |
| :--- | :--- | :---: | :---: | :---: | :--- |
| `GET /track` | Отправка координат | 1 776 | 20 555 | 82 220 | 7,4 млн поездок × 240 обновлений |
| `POST /order` | Создание заказа такси | 7,4 | 85 | 340 | 2,7 млрд поездок в год / 365 дней |
| `GET /driver-search` | Поиск водителей | 140 | 1 620 | 6 480 | 14 млн DAU × 10 запросов поиска перед заказом |
| `POST /payment` | Обработка платежа | 7,4 | 85 | 340 | 1 платеж на завершенную поездку |
| `POST /rating` | Оценка поездки | 7,4 | 85 | 340 | 1 оценка на завершенную поездку |
| `Auth / session` | Авторизация и валидация токена | 21 | 243 | 972 | 1.5 запроса × 14 млн DAU = 21 млн/день |
| **ИТОГО** | **Суммарная нагрузка на API** | **1 955** | **22 631** | **90 524** | |

---

## Список источников

1. https://tass.ru/ekonomika/23194545
2. https://yastatic.net/s3/ir-docs/prospectus/reports/2024/ENG_YANDEX_AR2024.pdf
3. https://inclient.ru/yandex-stats/?ysclid=mlmi600m3l368028847#go
4. https://longterminvestments.ru/yandex-analysis-part3/?ysclid=mlmhqfxl5w628021417
5. https://yastatic.net/s3/ir-docs/docs/2025/q3/25b90c11d0060d861ec0957dbbb96eeb/3Q25_IR_Presentation_RUS_6eeb.pdf
6. https://www.cnews.ru/news/line/2024-12-27_yandeks_go_podvel_itogi_2024
7. https://yandex.ru/company/researches/2015/moscow/taxi
8. https://yandex.ru/company/researches/2013/ya_moscow_taxi_2013?ysclid=mm2c8c2tm9231246010
9. https://dev.go.yandex/blog/yandex-taxi-reliability-2024-05-30?ysclid=mm2aurxhim271627780
10. https://dev.go.yandex/blog/dynamic-pricing-platform-2024-06-15
11. https://marketing.rbc.ru/articles/15705/?ysclid=mm2ctqfa4v506299390
12. https://www.autonews.ru/news/5cd2d6e09a79475ada66abc1?ysclid=mm2dd85d10855999250
